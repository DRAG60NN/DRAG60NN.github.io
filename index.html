<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Билет</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet" />
  <style>
    /* Основные стили страницы */
    body {
      margin: 0;
      font-family: 'Roboto', sans-serif;
      background-color: #2b2b2b;
      color: #fff;
    }
    .container {
      padding: 20px;
      padding-bottom: 80px; /* Отступ снизу для кнопки */
    }
    .top-text {
      text-align: center;
      font-size: 20px;
      font-weight: 500;
      margin-bottom: 15px;
      color: #fff;
    }
    .tab {
      display: flex;
      justify-content: space-around;
      border-bottom: 1px solid #444;
      margin-bottom: 20px;
    }
    .tab-item {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 16px;
      color: #ccc;
      padding: 10px 0;
      position: relative;
      cursor: pointer;
      user-select: none;
    }
    .tab-item.active {
      color: #e21a1a;
      font-weight: 500;
    }
    .tab-item.active::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 0;
      right: 0;
      height: 3px;
      background-color: #e21a1a;
    }
    .section {
      border-bottom: 1px solid #444;
      padding: 15px 0;
      opacity: 0;
      transform: translateY(10px);
      animation: fadeIn 0.3s ease-out forwards;
    }
    .label {
      color: #b0b0b0;
      font-size: 14px;
      font-weight: 300;
    }
    .value {
      font-size: 20px;
      font-weight: 500;
      margin-top: 5px;
    }
    .value-small {
      font-size: 14px;
      color: #aaa;
      margin-top: 3px;
      font-weight: 300;
    }
    /* Кнопка "ЗАКРЫТЬ" - всегда отображается на основном экране */
    .bottom-button {
      width: 100%;
      background-color: #e21a1a;
      color: white;
      text-align: center;
      padding: 18px 0;
      font-weight: bold;
      font-size: 18px;
      position: fixed;
      bottom: 10px; /* Приподнята от низа */
      left: 0;
      border-radius: 12px; /* Закругляем углы */
      cursor: pointer;
      user-select: none;
      box-shadow: 0 2px 6px rgba(226, 26, 26, 0.6);
      z-index: 1000;
    }
    .row {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .icon {
      width: 24px;
      height: 24px;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .icon svg {
      width: 100%;
      height: 100%;
      fill: #aaa;
    }
    .screen {
      display: none;
    }
    .screen.active {
      display: block;
    }
    @keyframes fadeIn {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    .qr-container {
      background: #fff;
      padding: 20px;
      display: flex;
      justify-content: center;
      border-radius: 12px;
    }
    .qr-container img {
      width: 220px;
      height: 220px;
      border-radius: 12px;
    }
    .input-screen {
      padding: 40px 20px;
    }
    .input-screen input {
      width: 100%;
      padding: 12px;
      margin-bottom: 15px;
      font-size: 16px;
      border: none;
      border-radius: 4px;
    }
    .input-screen button {
      width: 100%;
      padding: 14px;
      font-size: 16px;
      font-weight: bold;
      background-color: #e21a1a;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <!-- Экран ввода данных -->
  <div class="screen active" id="inputScreen">
    <div class="input-screen">
      <input id="inputCarrier" placeholder="Перевозчик (например: КПАТП-5)" />
      <input id="inputRoute" placeholder="Маршрут (например: 3-я Дальневосточная - Молодежная)" />
      <input id="inputPlate" placeholder="Госномер (например: в447рр124)" />
      <input id="inputFare" placeholder="Стоимость (например: 35.00)" />
      <input id="inputCount" placeholder="Количество билетов (например: 1)" />
      <button onclick="submitForm()">Продолжить</button>
    </div>
  </div>

  <!-- Основной экран с вкладками -->
  <div class="container screen" id="mainScreen">
    <div class="top-text">Действует: <span id="countdown">15</span> сек.</div>

    <div class="tab" id="tabs">
      <div class="tab-item active" onclick="switchTab('ticket', event)">
        <div class="icon">
          <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/></svg>
        </div>
        <div>1 070 004 271</div>
      </div>
      <div class="tab-item" onclick="switchTab('control', event)">     
  <div class="icon">
    <svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
      <g id="#282525ff">
      </g>
      <g id="#ca211fff">
        <path fill="#ca211f" opacity="1.00" d=" M 70.74 31.51 C 81.83 31.06 92.91 31.97 104.00 31.65 C 110.82 31.68 118.83 31.75 123.76 37.24 C 126.38 41.26 126.20 46.38 126.44 51.00 C 126.34 58.66 126.89 66.35 126.18 73.97 C 126.13 79.14 116.09 80.87 116.47 74.65 C 116.50 65.45 115.54 56.28 115.56 47.08 C 115.57 45.69 115.34 43.63 113.57 43.53 C 107.73 42.96 101.84 43.51 96.00 42.82 C 82.89 42.67 69.66 41.61 56.64 43.80 C 53.49 44.53 53.40 48.40 53.33 51.01 C 53.47 76.94 53.21 102.88 53.45 128.80 C 53.16 132.81 58.03 133.17 60.94 133.32 C 70.63 133.30 80.35 133.82 90.00 132.69 C 94.81 132.75 99.89 131.89 104.52 133.52 C 108.20 136.00 111.52 139.42 113.09 143.65 C 110.09 144.18 107.05 144.57 104.00 144.47 C 93.67 144.30 83.34 144.49 73.01 144.47 C 65.80 144.44 58.48 144.85 51.41 143.19 C 47.42 142.37 44.31 139.13 42.81 135.46 C 40.98 130.87 41.91 125.83 41.22 121.05 C 40.26 116.03 41.84 111.03 41.65 106.00 C 41.45 92.66 41.73 79.33 41.56 66.00 C 41.38 58.96 42.71 51.99 42.52 44.94 C 42.13 39.43 46.43 34.45 51.50 32.86 C 57.79 31.26 64.32 31.76 70.74 31.51 Z" />
        <path fill="#ca211f" opacity="1.00" d=" M 68.37 61.26 C 73.12 59.96 78.13 60.67 82.99 60.50 C 88.54 60.77 94.22 59.93 99.67 61.24 C 103.71 62.20 105.50 69.85 100.86 71.18 C 96.28 71.86 91.62 71.39 87.00 71.50 C 80.91 71.36 74.70 72.00 68.72 70.55 C 63.85 70.33 64.55 62.58 68.37 61.26 Z" />
        <path fill="#ca211f" opacity="1.00" d=" M 64.68 82.70 C 65.84 80.96 68.18 81.54 69.95 81.32 C 78.96 81.44 87.97 81.31 96.99 81.39 C 99.46 81.51 102.74 81.44 104.08 83.98 C 105.24 86.39 104.10 89.04 103.43 91.42 C 97.30 91.91 91.14 91.26 85.03 92.04 C 80.45 92.58 75.82 92.76 71.21 92.55 C 68.90 92.45 66.50 91.84 64.72 90.28 C 64.08 87.82 64.04 85.16 64.68 82.70 Z" />
        <path fill="#ca211f" opacity="1.00" d=" M 128.32 82.18 C 135.66 80.80 143.65 81.01 150.42 84.48 C 159.08 88.52 166.43 96.43 168.25 105.98 C 169.07 113.30 168.10 121.07 164.58 127.62 C 161.38 132.62 157.39 137.50 151.87 140.04 C 146.34 142.68 140.25 145.18 133.99 144.15 C 127.83 143.22 122.06 140.49 116.85 137.17 C 103.10 126.01 101.54 102.06 115.19 90.19 C 118.96 86.69 123.26 83.47 128.32 82.18 M 140.85 110.87 C 138.45 112.75 136.36 115.89 132.99 115.77 C 129.89 116.26 128.45 113.04 126.38 111.41 C 125.37 110.10 123.49 110.58 122.90 112.01 C 123.95 116.03 126.51 119.66 129.79 122.18 C 132.45 123.32 135.71 122.73 137.99 120.97 C 142.23 117.97 146.00 114.19 148.74 109.75 C 149.88 108.03 149.63 105.86 149.87 103.90 C 146.01 104.87 143.82 108.53 140.85 110.87 Z" />
        <path fill="#ca211f" opacity="1.00" d=" M 64.35 103.32 C 69.56 100.12 76.30 101.16 81.69 103.40 C 84.14 104.15 85.32 106.94 84.28 109.25 C 82.37 111.83 78.91 111.62 76.05 111.71 C 72.63 111.68 69.14 111.94 65.77 111.20 C 63.42 109.37 64.77 105.89 64.35 103.32 Z" />
      </g>
    </svg>
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM7 12l5 5V7l-5 5z"/>
          </svg>
        </div>
        Контроль
      </div>
    </div>

    <!-- Вкладка билета -->
    <div id="ticket" class="screen active">
      <div class="section">
        <div class="row">
          <div class="icon">
            <svg viewBox="0 0 24 24"><rect x="4" y="4" width="16" height="16"/></svg>
          </div>
          <div>
            <div class="label">Перевозчик</div>
            <div class="value" id="carrierOutput">КПАТП-5</div>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="row">
          <div class="icon">
            <svg viewBox="0 0 24 24"><path d="M5 12h14"/></svg>
          </div>
          <div>
            <div class="value-small" id="routeOutput">3-я Дальневосточная - Молодежная</div>
            <div class="value" id="plateOutput">в447рр124</div>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="row">
          <div class="icon">
            <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/></svg>
          </div>
          <div>
            <div class="label">Стоимость</div>
            <div class="value" id="fareOutput">1 шт., Полный, 35.00 ₽</div>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="row">
          <div class="icon">
            <svg viewBox="0 0 24 24"><path d="M12 2v20"/></svg>
          </div>
          <div>
            <div class="label">Дата покупки</div>
            <div class="value" id="dateOutput">--</div>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="row">
          <div class="icon">
            <svg viewBox="0 0 24 24"><path d="M2 12h20"/></svg>
          </div>
          <div>
            <div class="label">Время покупки</div>
            <div class="value" id="timeOutput">--:--</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Вкладка контроля с QR-кодом -->
    <div id="control" class="screen">
      <div class="qr-container">
        <!-- Пример QR-кода, ссылка для демонстрации -->
        <img src="https://api.qrserver.com/v1/create-qr-code/?size=220x220&data=ExampleQRCode" alt="QR Code" />
      </div>
    </div>
  </div>

  <!-- Кнопка закрыть, отображается всегда на основном экране -->
  <div class="bottom-button" id="closeButton" onclick="closeApp()">ЗАКРЫТЬ</div>

  <script>
    // Получаем элементы для управления
    const inputScreen = document.getElementById('inputScreen');
    const mainScreen = document.getElementById('mainScreen');
    const countdownEl = document.getElementById('countdown');
    const dateOutput = document.getElementById('dateOutput');
    const timeOutput = document.getElementById('timeOutput');
    const closeButton = document.getElementById('closeButton');

    // Выводы для билета
    const carrierOutput = document.getElementById('carrierOutput');
    const routeOutput = document.getElementById('routeOutput');
    const plateOutput = document.getElementById('plateOutput');
    const fareOutput = document.getElementById('fareOutput');

    // Вкладки и экраны
    const tabs = document.querySelectorAll('.tab-item');
    const screens = document.querySelectorAll('#mainScreen > .screen');

    // Дефолтные данные, если что-то не введено
    const defaultData = {
      carrier: 'КПАТП-5',
      route: '3-я Дальневосточная - Молодежная',
      plate: 'в447рр124',
      fare: '35.00',
      count: '1',
    };

    let countdownInterval;

    // Функция переключения вкладок
    function switchTab(tabName, event) {
      tabs.forEach(tab => {
        if (tab.textContent.trim() === 'Контроль' && tabName === 'control') {
          tab.classList.add('active');
        } else if (tab.textContent.trim() !== 'Контроль' && tabName === 'ticket') {
          tab.classList.add('active');
        } else {
          tab.classList.remove('active');
        }
      });
      // Показываем/скрываем экраны по имени вкладки
      if (tabName === 'ticket') {
        document.getElementById('ticket').classList.add('active');
        document.getElementById('control').classList.remove('active');
      } else {
        document.getElementById('ticket').classList.remove('active');
        document.getElementById('control').classList.add('active');
      }
    }

    // Запуск обратного отсчета
    function startCountdown() {
      let time = 15;
      countdownEl.textContent = time;
      countdownInterval = setInterval(() => {
        time--;
        if (time <= 0) {
          clearInterval(countdownInterval);
          countdownEl.textContent = '0';
          // Можно добавить действие по окончании отсчета, если нужно
        } else {
          countdownEl.textContent = time;
        }
      }, 1000);
    }

    // Функция обработки формы
    function submitForm() {
      // Считываем значения из инпутов
      const carrier = document.getElementById('inputCarrier').value.trim() || defaultData.carrier;
      const route = document.getElementById('inputRoute').value.trim() || defaultData.route;
      const plate = document.getElementById('inputPlate').value.trim() || defaultData.plate;
      const fare = document.getElementById('inputFare').value.trim() || defaultData.fare;
      const count = document.getElementById('inputCount').value.trim() || defaultData.count;

      // Заполняем данные на основном экране
      carrierOutput.textContent = carrier;
      routeOutput.textContent = route;
      plateOutput.textContent = plate;
      fareOutput.textContent = `${count} шт., Полный, ${fare} ₽`;

      // Устанавливаем текущие дату и время
      const now = new Date();
      dateOutput.textContent = now.toLocaleDateString('ru-RU');
      timeOutput.textContent = now.toLocaleTimeString('ru-RU', {hour: '2-digit', minute: '2-digit'});

      // Скрываем экран ввода, показываем основной
      inputScreen.classList.remove('active');
      mainScreen.classList.add('active');

      // Запускаем таймер
      startCountdown();
    }

    // Функция "Закрыть" - просто сбрасывает к экрану ввода
    function closeApp() {
      clearInterval(countdownInterval);
      inputScreen.classList.add('active');
      mainScreen.classList.remove('active');

      // Очищаем инпуты
      ['inputCarrier','inputRoute','inputPlate','inputFare','inputCount'].forEach(id => {
        document.getElementById(id).value = '';
      });

      // Сброс вкладок к первой
      switchTab('ticket');
    }

    // Инициализация: отображаем вкладку "1 070 004 271" и активируем кнопку "ЗАКРЫТЬ"
    switchTab('ticket');

    // Кнопка "ЗАКРЫТЬ" всегда видна только на основном экране
    function updateCloseButtonVisibility() {
      if (mainScreen.classList.contains('active')) {
        closeButton.style.display = 'block';
      } else {
        closeButton.style.display = 'none';
      }
    }

    // Следим за сменой экранов и обновляем видимость кнопки
    const observer = new MutationObserver(updateCloseButtonVisibility);
    observer.observe(mainScreen, { attributes: true, attributeFilter: ['class'] });

    // Изначальный вызов
    updateCloseButtonVisibility();

  </script>
</body>
</html>
